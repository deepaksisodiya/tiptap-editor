(function(t){function e(e){for(var i,s,a=e[0],c=e[1],d=e[2],l=0,h=[];l<a.length;l++)s=a[l],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(i=!1)}i&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},o={app:0},r=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/tiptap-editor/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var d=0;d<a.length;d++)e(a[d]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0436":function(t,e,n){"use strict";var i=n("77eb"),o=n.n(i);o.a},"0751":function(t,e,n){"use strict";var i=n("f397"),o=n.n(i);o.a},"4a82":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("a026"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Demo")},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"demo"},[n("div",{staticClass:"article-container"},[n("Article",{attrs:{onUpdatePost:t.onUpdatePost,uploadImage:t.uploadImage,uploadAudio:t.uploadAudio,getEmbeds:t.getEmbeds,content:t.getContent(),delayUpdateBy:"300"}})],1),n("vue-json-pretty",{attrs:{path:"res",data:t.blocks}})],1)},a=[],c=(n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("2fa7")),d=n("d538"),u=n.n(d),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[n("article",[n("editor-menu-bubble",{attrs:{editor:t.editor}}),n("editor-floating-menu",{ref:"floatingMenu",attrs:{editor:t.editor,"before-upload":t.beforeUpload}}),n("editor-content",{staticClass:"editor__content",attrs:{id:"editor",editor:t.editor}}),n("div",{staticClass:"ios-test-fix"},[t._v("empt")])],1)])},h=[],p=(n("99af"),n("caad"),n("b0c0"),n("2532"),n("18a5"),n("284c")),f=n("cd42"),m=n("f23d"),v=n("986d"),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor__floating-menu",class:{"is-plus-active":t.menu.isActive},style:"top: "+(t.menu.top-20)+"px"},[n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"imageInput",attrs:{type:"file",id:"image-input",accept:"image/*"},on:{change:function(e){return t.previewFiles(t.commands.image)}}}),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"audioInput",attrs:{type:"file",id:"audio-input"},on:{change:function(e){return t.previewAudio(t.commands.audio)}}}),n("ul",{staticClass:"kitchensink"},[n("li",{on:{click:t.toggleMenu}},[n("i",{staticClass:"add-icon",class:{"close-icon":t.shouldShowMenu}})]),t.shouldShowMenu?n("li",{on:{click:function(e){return t.onClickImage()}}},[n("i",{staticClass:"image-icon"})]):t._e(),t.shouldShowMenu?n("li",{class:{"is-active":t.isActive.embed()},on:{click:function(e){return t.onClickEmbed(t.commands.embed,"video")}}},[n("i",{staticClass:"video-icon"})]):t._e(),t.shouldShowMenu?n("li",{on:{click:function(e){return t.onClickAudio()}}},[n("i",{staticClass:"audio-icon"})]):t._e(),t.shouldShowMenu?n("li",{class:{"is-active":t.isActive.ordered_list()},on:{click:function(e){return t.onClickMenuItem(t.commands.ordered_list)}}},[n("i",{staticClass:"list-icon"})]):t._e(),t.shouldShowMenu?n("li",{class:{"is-active":t.isActive.embed()},on:{click:function(e){return t.onClickEmbed(t.commands.embed,"link")}}},[n("i",{staticClass:"link-icon"})]):t._e(),t.shouldShowMenu?n("li",{class:{"is-active":t.isActive.horizontal_rule()},on:{click:function(e){return t.onClickMenuItem(t.commands.horizontal_rule)}}},[n("i",{staticClass:"separator-icon"})]):t._e(),t.shouldShowMenu?n("li",{staticStyle:{display:"none"}},[n("i",{staticClass:"kitchensink-divider"})]):t._e()])])},b=[],w=n("9f12"),y=n("53fe");function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function A(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}var C=function(){function t(e){var n=this,i=e.options,o=e.editorView;Object(w["a"])(this,t),this.options=O({},{resizeObserver:!0,element:null,onUpdate:function(){return!1}},{},i),this.preventHide=!1,this.editorView=o,this.isActive=!1,this.top=0,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(t){var e=t.view;n.update(e)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(t){var e=t.event;n.preventHide?n.preventHide=!1:n.hide(e)},this.options.editor.on("blur",this.blurHandler),this.options.resizeObserver&&window.ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(){n.isActive&&n.update(n.editorView)})),this.resizeObserver.observe(this.editorView.dom))}return Object(y["a"])(t,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"update",value:function(t,e){var n=t.state,i=t.dom,o=n.doc.content.content.length,r=3===o&&!i.children[2].textContent,s=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,a=s&&n.doc.content.content[o-2].type.name.includes("image");if(!(t.hasFocus()&&e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty){var c=t.domAtPos(n.selection.anchor),d=r||"<br>"===c.node.innerHTML&&"P"===c.node.tagName&&c.node.parentNode===t.dom;if(d){var u=this.options.element.offsetParent;if(u){var l=u.getBoundingClientRect(),h=r||a?A(i.children[a?o-1:2].getBoundingClientRect(),!1):t.coordsAtPos(n.selection.anchor),p=h.top-l.top+(r||a?3.5:0);this.isActive=!0,this.top=p,this.sendUpdate()}else this.hide()}else this.hide()}else this.hide()}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,top:this.top})}},{key:"hide",value:function(t){t&&t.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(t.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.resizeObserver&&this.resizeObserver.unobserve(this.editorView.dom),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),t}(),j=function(t){return new f["g"]({key:new f["h"]("floating_menu"),view:function(e){return new C({editorView:e,options:t})}})},S={props:{editor:{default:null,type:Object},beforeUpload:{type:Function,default:function(){return!0}}},data:function(){return{menu:{isActive:!1,left:0,bottom:0},addImageAt:null,addAudioAt:null,shouldShowMenu:!1}},computed:{focused:function(){return this.editor.view.focused},focus:function(){return this.editor.focus},commands:function(){return this.editor.commands},isActive:function(){return this.editor.isActive},getMarkAttrs:function(){return this.editor.getMarkAttrs.bind(this.editor)},getNodeAttrs:function(){return this.editor.getNodeAttrs&&this.editor.getNodeAttrs.bind(this.editor)},hasLock:function(){return Object(v["contains"])(this.editor.view.state.doc,this.editor.schema.nodes.lock)}},watch:{editor:{immediate:!0,handler:function(t){var e=this;t&&t&&this.$nextTick((function(){t.registerPlugin(j({editor:t,element:e.$el,onUpdate:function(t){t.isActive&&!1===e.menu.isActive?e.$emit("show",t):t.isActive||!0!==e.menu.isActive||e.$emit("hide",t),e.menu=t}}))}))}},shouldShowMenu:function(){var t=this.editor.state.doc.content.content;2===t.length&&this.editor.setOptions({})}},beforeDestroy:function(){this.editor.unregisterPlugin("floating_menu")},methods:{onClickImage:function(){this.addImageAt=this.editor.view.state.tr.selection.head,this.$refs.imageInput.click(),this.hideFloatingMenu()},onClickAudio:function(){this.addAudioAt=this.editor.view.state.tr.selection.head,this.$refs.audioInput.click(),this.hideFloatingMenu()},previewFiles:function(t){var e=this,n=this.$refs.imageInput,i=n.files[0];if(!i||this.beforeUpload(i,"image")){if(i){var o=new FileReader;o.onload=function(){var n=new Image;n.src=o.result,t({src:{fallback:n.src},addImageAt:e.addImageAt})},o.readAsDataURL(i)}}else n.value=""},previewAudio:function(t){var e=this,n=this.$refs.audioInput,i=n.files[0];if(!i||this.beforeUpload(i,"audio")){if(i){var o=new FileReader;o.onload=function(){t({src:o.result,addAudioAt:e.addAudioAt})},o.readAsDataURL(i)}}else n.value=""},toggleMenu:function(t){if(!this.shouldShowMenu){var e=this.editor.view.posAtCoords({left:t.clientX+100,top:t.clientY});this.editor.setSelection(e.pos,e.pos)}this.shouldShowMenu=!this.shouldShowMenu,this.editor.setOptions({})},onClickEmbed:function(t,e){t({type:e}),this.hideFloatingMenu()},onClickMenuItem:function(t){t(),this.hideFloatingMenu()},hideFloatingMenu:function(){this.shouldShowMenu=!1}}},E=S,P=n("2877"),x=Object(P["a"])(E,g,b,!1,null,null,null),_=x.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isInputActive?n("div",{ref:"linkDiv",class:["highlight-menu-input",t.ios?"ios":""],style:t.getStyle(t.menu)},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.href,expression:"href"}],attrs:{type:"text",placeholder:"Paste or type a link"},domProps:{value:t.href},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.addAnchor(t.editor.commands.link,t.href))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.hideInput(e)}],input:function(e){e.target.composing||(t.href=e.target.value)}}}),n("i",{staticClass:"toolbar-close-icon",on:{click:function(e){return t.addAnchor(t.editor.commands.link,t.href)}}})]):n("ul",{ref:"menuUl",staticClass:"highlight-menu",class:{"is-active":t.menu.isActive&&!t.isTitleSelected(),ios:t.ios},style:t.getStyle(t.menu)},[n("li",{on:{click:t.commands.bold}},[n("button",[n("i",{staticClass:"bold-icon",class:{"is-active":t.isActive.bold()}})])]),n("li",{on:{click:t.commands.italic}},[n("button",[n("i",{staticClass:"italic-icon",class:{"is-active":t.isActive.italic()}})])]),n("li",{on:{click:function(e){t.showInput(t.getMarkAttrs("link"))}}},[n("button",[n("i",{staticClass:"link-icon",class:{"is-active":t.isActive.link()}})])]),t._m(0),n("li",{on:{click:function(e){return t.commands.heading({level:3})}}},[n("button",[n("i",{staticClass:"large-heading-icon",class:{"is-active":t.isActive.heading({level:3})}})])]),n("li",{on:{click:function(e){return t.commands.heading({level:5})}}},[n("button",[n("i",{staticClass:"small-heading-icon",class:{"is-active":t.isActive.heading({level:5})}})])]),n("li",{on:{click:t.commands.blockquote}},[n("button",[n("i",{staticClass:"quote-icon",class:{"is-active":t.isActive.blockquote()}})])])])])},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("button",[n("i",{staticClass:"separator-icon"})])])}],D=(n("ac1f"),{}),$=D;if("undefined"!=typeof navigator&&"undefined"!=typeof document){var T=/Edge\/(\d+)/.exec(navigator.userAgent),N=/MSIE \d/.test(navigator.userAgent),z=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);D.mac=/Mac/.test(navigator.platform);var U=D.ie=!!(N||z||T);D.ie_version=N?document.documentMode||6:z?+z[1]:T?+T[1]:null,D.gecko=!U&&/gecko\/(\d+)/i.test(navigator.userAgent),D.gecko_version=D.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var L=!U&&/Chrome\/(\d+)/.exec(navigator.userAgent);D.chrome=!!L,D.chrome_version=L&&+L[1],D.ios=!U&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),D.android=/Android \d/.test(navigator.userAgent),D.webkit="webkitFontSmoothing"in document.documentElement.style,D.safari=/Apple Computer/.test(navigator.vendor),D.webkit_version=D.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){var i=document.createRange();return i.setEnd(t,null==n?t.nodeValue.length:n),i.setStart(t,e||0),i}function B(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}function H(t,e){var n,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.docView.domFromPos(e),s=r.node,a=r.offset;if(3===s.nodeType)o&&a<s.nodeValue.length?(i=B(F(s,a-1,a),-1),n="right"):a<s.nodeValue.length&&(i=B(F(s,a,a+1),-1),n="left");else if(s.firstChild){if(a<s.childNodes.length){var c=s.childNodes[a];i=B(3===c.nodeType?F(c):c,-1),n="left"}if((!i||i.top===i.bottom)&&a){var d=s.childNodes[a-1];i=B(3===d.nodeType?F(d):d,1),n="right"}}else i=s.getBoundingClientRect(),n="left";var u=i[n];return{top:i.top,bottom:i.bottom,left:u,right:u}}var q=function(){function t(e){var n=this,i=e.options,o=e.editorView;Object(w["a"])(this,t),this.options=V({},{element:null,keepInBounds:!0,onUpdate:function(){return!1}},{},i),this.editorView=o,this.isActive=!1,this.left=0,this.bottom=0,this.top=0,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(t){var e=t.view;n.update(e)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(t){var e=t.event;n.preventHide?n.preventHide=!1:n.hide(e)},this.options.editor.on("blur",this.blurHandler)}return Object(y["a"])(t,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"update",value:function(t,e){var n=t.state;if(!t.composing&&!(e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty)this.hide();else{var i=n.selection,o=i.from,r=i.to,s=H(t,o),a=H(t,r,!0),c=this.options.element.offsetParent;if(c){var d=c.getBoundingClientRect(),u=this.options.element.firstElementChild.getBoundingClientRect(),l=(s.left+a.left)/2-d.left;this.left=Math.round(this.options.keepInBounds?Math.min(d.width-u.width/2,Math.max(l,u.width/2)):l)-Math.round(u.width/2),this.bottom=Math.round(d.bottom-s.top),this.top=Math.round(a.bottom-d.top)}this.isActive=!0,this.sendUpdate()}}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,left:this.left,bottom:this.bottom,top:this.top})}},{key:"hide",value:function(t){t&&t.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(t.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),t}(),W=function(t){return new f["g"]({key:new f["h"]("menu_bubble"),view:function(e){return new q({editorView:e,options:t})}})},K=(n("4d63"),n("25f0"),n("466d"),n("5319"),n("498a"),function(t){var e=new RegExp(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i);return!!t.match(e)}),J=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=window.decodeURIComponent(t);return e=e.trim().replace(/\s/g,""),/^(:\/\/)/.test(e)?"https".concat(e):/^(f|ht)tps?:\/\//i.test(e)?e:"https://".concat(e)},X={props:{editor:{default:null,type:Object}},data:function(){return{href:null,isInputActive:!1,ios:$.ios,menu:{isActive:!1,left:0,bottom:0}}},computed:{focused:function(){return this.editor.view.focused},focus:function(){return this.editor.focus},commands:function(){return this.editor.commands},isActive:function(){return this.editor.isActive},getMarkAttrs:function(){return this.editor.getMarkAttrs.bind(this.editor)},getNodeAttrs:function(){return this.editor.getNodeAttrs&&this.editor.getNodeAttrs.bind(this.editor)}},watch:{editor:{immediate:!0,handler:function(t){var e=this;t&&this.$nextTick((function(){t.registerPlugin(W({editor:t,element:e.$el,keepInBounds:!0,onUpdate:function(t){t.isActive&&!1===e.menu.isActive?(e.ios&&e.fixMenuEl(),e.$emit("show",t)):t.isActive||!0!==e.menu.isActive||e.$emit("hide",t),e.menu=t}}))}))}},"menu.isActive":function(t){t||(this.isInputActive=!1)}},mounted:function(){this.ios&&(window.addEventListener("scroll",this.fixMenuEl),window.addEventListener("resize",this.fixMenuEl),window.visualViewport.addEventListener("scroll",this.fixMenuEl),window.visualViewport.addEventListener("resize",this.fixMenuEl))},beforeDestroy:function(){this.ios&&(window.removeEventListener("scroll",this.fixMenuEl),window.removeEventListener("resize",this.fixMenuEl),window.visualViewport.removeEventListener("scroll",this.fixMenuEl),window.visualViewport.removeEventListener("resize",this.fixMenuEl)),this.editor.unregisterPlugin("menu_bubble")},methods:{getStyle:function(t){return window.screen.width>=786?"left: ".concat(t.left,"px; bottom: ").concat(t.bottom,"px;"):""},showInput:function(t){var e=this;this.href=t.href,this.isInputActive=!0,this.$nextTick((function(){e.ios&&e.fixMenuEl(),e.$refs.linkDiv.querySelector("input").focus()}))},addAnchor:function(t,e){var n;e&&(n=J(e)),t({href:n}),this.hideInput(),this.menu.isActive=!0},hideInput:function(){var t=this;this.href=null,this.isInputActive=!1,this.$nextTick((function(){t.ios&&t.fixMenuEl()}))},isTitleSelected:function(){var t=this.editor.view.state.tr.selection,e=t.$from,n=t.$to;return"title"===e.parent.type.name&&"title"===n.parent.type.name},fixMenuEl:function(){var t=this.$refs.menuUl,e=this.$refs.linkDiv,n=window.visualViewport.pageTop,i=document.getElementsByClassName("editor")[0];e&&(e.style.top="".concat(n-i.offsetTop,"px")),t&&(t.style.top="".concat(n-i.offsetTop,"px"))}}},Y=X,G=Object(P["a"])(Y,M,I,!1,null,null,null),Q=G.exports,Z=n("8b83"),tt=n("c65a"),et=n("c03e"),nt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"schema",get:function(){return{content:"header featuredimage block+"}}}]),e}(f["a"]),it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.embeds.data.url?t._e():n("ul",{staticClass:"kitchensink embed-input-open"},[n("li",{on:{click:t.deleteNode}},[n("i",{staticClass:"add-icon close-icon"})]),!0===t.embeds.isLoading?n("li",{staticClass:"embed-input"},[n("i",{staticClass:"loading-icon"}),n("span",[t._v(t._s(t.loadingText))])]):t._e(),!1===t.embeds.isLoading?n("li",{staticClass:"embed-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],ref:"embedInput",attrs:{placeholder:t.placeholderText,type:"url",disabled:!t.view.editable},domProps:{value:t.url},on:{paste:function(t){t.stopPropagation()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickAdd(e)},input:function(e){e.target.composing||(t.url=e.target.value)}}}),n("button",{class:{active:t.isButtonActive},attrs:{disabled:!t.isButtonActive},on:{click:t.onClickAdd}},[t._v(" Add ")])]):t._e()]),t.embeds.data.url&&"video"===t.embeds.data.type?n("div",{class:["embed-wrapper",t.embedWrapperClass]},[n("figure",{domProps:{innerHTML:t._s(t.embeds.data.html)}}),t.embeds.data.url&&"video"===t.embeds.data.type?n("figcaption",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.caption,expression:"caption"}],attrs:{type:"text",disabled:!t.view.editable,placeholder:"Type caption for video (optional)"},domProps:{value:t.caption},on:{keydown:t.handleKeydown,paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.caption=e.target.value)}}})]):t._e()]):t._e(),t.embeds.data.url&&"link"===t.embeds.data.type?n("div",{class:["embed-wrapper",{selected:t.shouldShowClose},t.embedWrapperClass],on:{click:t.onClickEmbed}},[n("div",{staticClass:"close-button",on:{click:t.deleteNode}},[n("i",{staticClass:"close-icon"})]),n("div",{class:{"embed-content":"Twitter"===t.embeds.data.provider||"Instagram"===t.embeds.data.provider},domProps:{innerHTML:t._s(t.embeds.data.html)}})]):t._e()])},ot=[],rt=(n("e01a"),n("d3b7"),n("96cf"),{name:"Embed",props:["node","updateAttrs","view","getPos","options","editor"],data:function(){return{isButtonActive:!1,shouldShowClose:!1,embeds:{isLoading:!1,isError:!1,data:{title:"",description:"",type:"",url:"",thumbnail_url:"",thumbnail_width:0,thumbnail_height:0,provider:"",html:"",caption:""}}}},inject:["getEditorVm"],mounted:function(){var t=this;if(this.getEditorVm().$watch("selectedEl",(function(e){t.shouldShowClose&&e!==t.$el&&(t.shouldShowClose=!1)})),this.url){var e={title:this.node.attrs.title,url:this.node.attrs.url,thumbnail_url:this.node.attrs.thumbnail_url,thumbnail_width:this.node.attrs.thumbnail_width,thumbnail_height:this.node.attrs.thumbnail_height,provider:this.node.attrs.provider,type:this.node.attrs.type,description:this.node.attrs.description,html:this.node.attrs.html};this.embeds.data=e,"link"===this.embeds.data.type&&this.$nextTick((function(){t.disableLink(),t.loadEmbeds()}))}else this.$nextTick((function(){t.$refs.embedInput.focus()}))},watch:{url:function(){this.url?this.isButtonActive=!0:this.isButtonActive=!1}},computed:{url:{get:function(){return this.node.attrs.url},set:function(t){this.updateAttrs({url:t})}},caption:{get:function(){return this.node.attrs.caption},set:function(t){this.updateAttrs({caption:t})}},placeholderText:function(){return"link"===this.node.attrs.type?"Paste or type a link":"Paste or type video link"},loadingText:function(){return"link"===this.node.attrs.type?"Embedding link…":"Embedding video…"},embedWrapperClass:function(){return this.node.attrs.provider?"".concat(this.node.attrs.provider.toLowerCase(),"-wrapper"):"standard-link-wrapper"}},methods:{loadScript:function(t,e){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,e())}:n.onload=function(){e()},n.src=t,document.getElementsByTagName("head")[0].appendChild(n)},loadEmbeds:function(){"Twitter"===this.embeds.data.provider&&(window.twttr?window.twttr.widgets.load():this.loadScript("https://platform.twitter.com/widgets.js",(function(){window.twttr.widgets.load()}))),"Instagram"===this.embeds.data.provider&&(window.instgrm?window.instgrm.Embeds.process():this.loadScript("https://www.instagram.com/embed.js",(function(){window.instgrm.Embeds.process()})))},onClickAdd:function(){var t,e,n,i,o,r,s=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(this.url){a.next=2;break}return a.abrupt("return");case 2:return t=this.view.state.tr,e=this.getPos(),n=f["i"].create(t.doc,e+1,e+1),t=t.setSelection(n),this.view.dispatch(t),i=J(this.url),this.updateAttrs({url:i}),this.embeds.isLoading=!0,this.embeds.isError=!1,a.prev=11,o=encodeURIComponent(i.trim()),a.next=15,regeneratorRuntime.awrap(this.options.getEmbeds(o));case 15:r=a.sent,this.embeds.data={title:r.data.attrs.title,description:r.data.attrs.description,url:r.data.attrs.url,provider:r.data.attrs.provider,thumbnail_url:r.data.attrs.thumbnail_url,thumbnail_width:r.data.attrs.thumbnail_width,thumbnail_height:r.data.attrs.thumbnail_height,html:r.data.attrs.html,type:r.data.attrs.type},this.updateAttrs(this.embeds.data),"link"===this.embeds.data.type&&this.$nextTick((function(){s.disableLink(),s.loadEmbeds()})),a.next=24;break;case 21:a.prev=21,a.t0=a["catch"](11),this.embeds.isError=!0;case 24:return a.prev=24,this.embeds.isLoading=!1,a.finish(24);case 27:case"end":return a.stop()}}),null,this,[[11,21,24,27]])},createAndMovetoNextParagraph:function(){var t=this.view.state,e=t.tr,n=t.schema,i=this.getPos(),o=f["i"].create(e.doc,i,i+1);e=e.setSelection(o).insertText(this.url);var r=n.nodes["paragraph"];e=e.insert(i+this.url.length+2,r.create()),o=f["i"].create(e.doc,i+this.url.length+2,i+this.url.length+2),e=e.setSelection(o),this.view.dispatch(e),this.view.focus()},validURL:function(t){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!e.test(t)},handleKeydown:function(t){var e=this.view.state.tr,n=this.getPos();if("Backspace"!==t.key||this.caption){if("Enter"===t.key){var i=f["i"].create(e.doc,n+2,n+2);this.view.dispatch(e.setSelection(i)),this.view.focus(),t.preventDefault()}}else{var o=f["i"].create(e.doc,n,n+1);this.view.dispatch(e.setSelection(o).deleteSelection(this.url)),this.view.focus()}},disableLink:function(){this.$el.querySelector("a").onclick=function(t){return t.preventDefault()}},onClickEmbed:function(){this.editor.blur(),this.shouldShowClose=!this.shouldShowClose,this.options.onSelection(this.shouldShowClose?this.$el:"")},deleteNode:function(){var t=this.view.state.tr,e=this.getPos(),n=f["i"].create(t.doc,e,e+1);this.view.dispatch(t.setSelection(n).deleteSelection(this.src)),this.view.focus()}}}),st=rt,at=(n("0751"),Object(P["a"])(st,it,ot,!1,null,"151a5591",null)),ct=at.exports,dt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"commands",value:function(t){var e=t.type;return function(t){return function(n,i){return i(n.tr.replaceSelectionWith(e.create(t)))}}}},{key:"name",get:function(){return"embed"}},{key:"schema",get:function(){return{attrs:{title:{default:""},description:{default:""},type:{default:""},url:{default:""},provider:{default:""},thumbnail_url:{default:""},thumbnail_width:{default:""},thumbnail_height:{default:""},html:{default:""},caption:{default:null}},group:"block",selectable:!1,parseDOM:[{tag:this.name,getAttrs:function(t){return{title:t.getAttribute("title"),description:t.getAttribute("description"),type:t.getAttribute("type"),url:t.getAttribute("url"),provider:t.getAttribute("provider"),thumbnail_url:t.getAttribute("thumbnail_url"),thumbnail_width:t.getAttribute("thumbnail_width"),thumbnail_height:t.getAttribute("thumbnail_height"),caption:t.getAttribute("caption"),html:t.getAttribute("html")}}}],toDOM:function(t){return["embed",t.attrs]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view","getPos","options","editor"],components:{Embed:ct},template:"\n        <Embed\n          :node='this.node'\n          :updateAttrs='this.updateAttrs'\n          :view='this.view'\n          :getPos='this.getPos'\n          :options='this.options'\n          :editor='this.editor'\n        ></Embed>\n      "}}}]),e}(f["f"]),ut=(n("a630"),n("3ca3"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("figure",{class:{selected:t.shouldShowClose}},[n("div",{staticClass:"close-button",on:{click:t.deleteNode}},[n("i",{staticClass:"close-icon"})]),n("picture",{on:{click:t.onImageClick}},[t.data.image?n("source",{attrs:{srcset:t.data.image,type:"image"}}):t._e(),n("source",{attrs:{srcset:t.data.fallback,type:"image"}}),n("img",{attrs:{src:t.data.fallback},on:{load:t.loaded}})]),n("figcaption",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.caption,expression:"caption"}],attrs:{placeholder:"Type caption for image (optional)"},domProps:{value:t.caption},on:{keydown:t.handleKeydown,paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.caption=e.target.value)}}})])])}),lt=[],ht={name:"ImageBlock",props:["node","updateAttrs","view","getPos","options"],data:function(){return{height:"",width:"",data:this.node.attrs.src,shouldShowClose:!1}},inject:["getEditorVm"],computed:{src:{get:function(){return this.node.attrs.src},set:function(t){this.updateAttrs({src:t})}},caption:{get:function(){return this.node.attrs.caption},set:function(t){this.updateAttrs({caption:t})}}},mounted:function(){var t=this;this.$nextTick((function(){t.view.focus(),t.$el.scrollIntoView(!0)})),this.getEditorVm().$watch("selectedEl",(function(e){t.shouldShowClose&&e!==t.$el&&(t.shouldShowClose=!1)}))},methods:{handleKeydown:function(t){var e=this.view.state.tr,n=this.getPos();if("Enter"===t.key){var i=f["i"].create(e.doc,n+2,n+2);this.view.dispatch(e.setSelection(i)),this.view.focus(),t.preventDefault()}},deleteNode:function(){var t=this.view.state.tr,e=this.getPos(),n=f["i"].create(t.doc,e,e+1);this.view.dispatch(t.setSelection(n).deleteSelection(this.src)),this.view.focus()},onImageClick:function(){!1===K(this.data&&this.data.fallback)&&(this.shouldShowClose=!this.shouldShowClose),this.options.onSelection(this.shouldShowClose?this.$el:"")},loaded:function(){var t,e,n,i;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:if(t=document.getElementById("image-input"),!this.data.fallback.includes("data:")||0==t.files.length){o.next=18;break}return e=this.src.file||t.files[0],n=new FormData,n.append("image",e),o.prev=5,o.next=8,regeneratorRuntime.awrap(this.options.uploadImage(n));case 8:i=o.sent,i&&200===i.status&&(this.src=i.data,this.data=i.data),o.next=15;break;case 12:o.prev=12,o.t0=o["catch"](5),this.deleteNode();case 15:return o.prev=15,t.value="",o.finish(15);case 18:case"end":return o.stop()}}),null,this,[[5,12,15,18]])}}},pt=ht,ft=Object(P["a"])(pt,ut,lt,!1,null,null,null),mt=ft.exports;function vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(n),!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var bt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t.src,i=t.addImageAt;return function(t,o){var r=t.tr,s=t.schema;r.doc.content.size-i===1&&(r=r.insert(r.doc.content.size,s.nodes["paragraph"].create()));var a=f["i"].create(r.doc,i,i);return r=r.setSelection(a).replaceSelectionWith(e.create({src:n})),o(r)}}}},{key:"schema",get:function(){return{attrs:{src:{default:""},alt:{default:""},caption:{default:""}},group:"block",selectable:!1,parseDOM:[{tag:'img[src][data-featured-image="false"]',getAttrs:function(t){return{src:JSON.parse(t.getAttribute("data-src")),alt:t.getAttribute("alt"),caption:t.getAttribute("caption")}}}],toDOM:function(t){return""===t.attrs.src?["paragraph"]:["img",gt({},t.attrs,{src:t.attrs.src&&t.attrs.src.fallback,"data-src":JSON.stringify(t.attrs.src),"data-featured-image":!1})]}}}},{key:"plugins",get:function(){var t=this;return[new f["g"]({props:{handleDOMEvents:{drop:function(e,n){var i=n.dataTransfer&&n.dataTransfer.files&&n.dataTransfer.files.length;if(i){var o=Array.from(n.dataTransfer.files).filter((function(t){return/image/i.test(t.type)}));if(0!==o.length){n.preventDefault();var r=e.state.schema,s=e.posAtCoords({left:n.clientX,top:n.clientY}),a=e.fImg.getPos();o.forEach((function(n){var i=new FileReader;i.onload=function(i){t.commands({type:r.nodes.image})({src:{fallback:i.target.result,file:n},addImageAt:s.pos<=a+1?a+1:s.pos})(e.state,e.dispatch)},i.readAsDataURL(n)}))}}}}}})]}},{key:"view",get:function(){return{props:["node","updateAttrs","view","getPos","options"],components:{ImageComponent:mt},template:"\n        <ImageComponent\n          :node='this.node'\n          :updateAttrs='this.updateAttrs'\n          :view='this.view'\n          :getPos='this.getPos'\n          :options='this.options'\n        ></ImageComponent>\n      "}}}]),e}(m["g"]),wt=n("a9de"),yt=(f["f"],function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"keys",value:function(){return{Enter:function(t,e,n){var i=t.tr,o=t.selection.anchor,r=t.schema.nodes.paragraph,s=o,a=n.selectionAtEnterKeydown.anchor;if($.ios&&(s=a),"title"!==i.doc.resolve(s).parent.type.name){if($.ios&&o-a===2&&!i.doc.resolve(a).parentOffset){var c=f["i"].create(i.doc,s,s+2);i=i.setSelection(c).deleteSelection(),e(i)}return!1}i.doc.nodeAt(s+3).textContent&&(i=i.insert(s+3,r.create()));var d=f["i"].create(i.doc,s+4,s+4);return i=i.setSelection(d),e(i),!0},Backspace:function(t,e,n){var i=n.fImg,o=t.tr,r=t.selection,s=r.anchor,a=r.empty,c=o.doc.resolve(s).parent.type.name,d=o.doc.nodeAt(s-2);if(d&&("image"===d.type.name||"embed"===d.type.name&&"link"===d.attrs.type||"featuredimage"===d.type.name&&(i.dataUrl||d.attrs.src)))return!0;if(a&&"header"!==c&&"title"!==c&&"header"===o.doc.resolve(s-3).parent.type.name){var u=f["i"].create(o.doc,s-4,s-4);return e(o.setSelection(u)),!0}return!1}}}},{key:"name",get:function(){return"title"}},{key:"schema",get:function(){return{content:"inline*",parseDOM:[{tag:"h1"}],toDOM:function(){return["h1",0]},marks:""}}}]),e}(f["f"])),kt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"commands",value:function(t){var e=t.type;return function(t){return function(n,i){var o=n.tr,r=n.schema;return o.doc.content.size-o.selection.head===1&&(o=o.insert(o.doc.content.size,r.nodes["paragraph"].create())),o=o.replaceSelectionWith(e.create(t)),i(o)}}}},{key:"schema",get:function(){return{group:"block",selectable:!1,parseDOM:[{tag:"hr"}],toDOM:function(){return["hr"]}}}}]),e}(m["f"]),Ot=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"name",get:function(){return"header"}},{key:"schema",get:function(){return{content:"title",selectable:!1,parseDOM:[{tag:"header"}],toDOM:function(){return["header",0]}}}}]),e}(f["f"]),At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{class:{"upload-picture-block":!t.data.fallback},staticStyle:{position:"relative"}},[t.data.fallback?t._e():[n("i",{staticClass:"upload-icon"}),n("span",[t._v("Upload feature image (optional)")]),n("input",{ref:"fileInput",staticStyle:{position:"absolute",opacity:"0",top:"0px",left:"0px",height:"100%",width:"100%","margin-top":"0px","margin-bottom":"0px"},attrs:{type:"file"},on:{change:function(e){return t.previewFiles()}}})],t.data.fallback?n("figure",{staticClass:"featured-image",class:{selected:t.shouldShowClose}},[n("div",{staticClass:"close-button",on:{click:t.removeImage}},[n("i",{staticClass:"close-icon"})]),n("picture",{on:{click:t.onImageClick}},[t.data.image?n("source",{attrs:{srcset:t.data.image,type:"image"}}):t._e(),n("source",{attrs:{srcset:t.data.fallback,type:"image"}}),n("img",{attrs:{src:t.data.fallback},on:{load:t.loaded}})]),n("figcaption",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.caption,expression:"caption"}],attrs:{placeholder:"Type caption for image (optional)"},domProps:{value:t.caption},on:{keydown:t.handleKeydown,paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.caption=e.target.value)}}})])]):t._e()],2)])},Ct=[],jt={name:"FeatureImage",props:["node","updateAttrs","view","getPos","options"],data:function(){return{data:this.node.attrs.src,shouldShowClose:!1}},inject:["getEditorVm"],watch:{"node.attrs.src":function(t){this.data.fallback||(this.data=t)}},computed:{src:{get:function(){return this.node.attrs.src},set:function(t){this.updateAttrs({src:t})}},caption:{get:function(){return this.node.attrs.caption},set:function(t){this.updateAttrs({caption:t})}}},mounted:function(){var t=this;this.view.fImg=this,this.getEditorVm().$watch("selectedEl",(function(e){t.shouldShowClose&&e!==t.$el&&(t.shouldShowClose=!1)}))},methods:{handleKeydown:function(t){var e=this.view.state.tr,n=this.getPos();if("Enter"===t.key){var i=f["i"].create(e.doc,n+2,n+2);this.view.dispatch(e.setSelection(i)),this.view.focus(),t.preventDefault()}},previewFiles:function(){var t=this,e=this.$refs.fileInput.files[0],n=/image.*/;if(e.type.match(n)){var i=new FileReader;i.onload=function(){var n,o,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return n=new Image,n.src=i.result,t.data={fallback:n.src},o=new FormData,o.append("image",e),s.prev=5,s.next=8,regeneratorRuntime.awrap(t.options.uploadImage(o));case 8:r=s.sent,r&&200===r.status&&(t.src=r.data,t.data=r.data),s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](5),t.src="",t.data="";case 16:case"end":return s.stop()}}),null,null,[[5,12]])},i.readAsDataURL(e)}},loaded:function(){var t=this;this.caption||(this.caption=" ",this.$nextTick((function(){t.caption=""})))},removeImage:function(){this.src="",this.data=""},onImageClick:function(){!1===K(this.data&&this.data.fallback)&&(this.shouldShowClose=!this.shouldShowClose),this.options.onSelection(this.shouldShowClose?this.$el:"")}}},St=jt,Et=Object(P["a"])(St,At,Ct,!1,null,null,null),Pt=Et.exports;function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Mt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t.src,i=t.addImageAt;return function(t,o){var r=t.tr,s=t.schema;r.doc.content.size-i===1&&(r=r.insert(r.doc.content.size,s.nodes["paragraph"].create()));var a=f["i"].create(r.doc,i,i);return r=r.setSelection(a).replaceSelectionWith(e.create({src:n})),o(r)}}}},{key:"name",get:function(){return"featuredimage"}},{key:"schema",get:function(){return{attrs:{src:{default:""},alt:{default:""},caption:{default:""}},group:"block",selectable:!1,toDOM:function(t){return["img",_t({},t.attrs,{"data-featured-image":!0})]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view","getPos","options"],components:{ImageComponent:Pt},template:"\n        <ImageComponent\n          :node='this.node'\n          :updateAttrs='this.updateAttrs'\n          :view='this.view'\n          :getPos='this.getPos'\n          :options='this.options'\n        ></ImageComponent>\n      "}}}]),e}(m["g"]),It=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"keys",value:function(t){var e=t.type;return{"Ctrl-Shift-6":Object(wt["r"])(e)}}},{key:"name",get:function(){return"sup"}},{key:"schema",get:function(){return{parseDOM:[{tag:"sup"}],toDOM:function(){return["sup",0]}}}}]),e}(f["e"]),Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("figure",{class:["audio-player-container",{selected:t.shouldShowClose}]},[n("div",{staticClass:"close-button",on:{click:t.deleteNode}},[n("i",{staticClass:"close-icon"})]),n("audio-player",{attrs:{src:t.data,disabled:t.disabled},on:{click:t.handlePlayerClick,error:t.handlePlayerError,loadedmetadata:t.onLoadedMetaData}}),n("figcaption",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.caption,expression:"caption"}],attrs:{placeholder:"Type caption for Audio (optional)"},domProps:{value:t.caption},on:{keydown:t.handleKeydown,paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.caption=e.target.value)}}})])],1)},$t=[],Tt=n("add8"),Nt=n.n(Tt),zt={name:"Audio",props:["node","updateAttrs","view","getPos","options","editor"],data:function(){return{data:this.node.attrs.src,shouldShowClose:!1}},inject:["getEditorVm"],components:{AudioPlayer:Nt.a},computed:{src:{get:function(){return this.node.attrs.src},set:function(t){this.updateAttrs({src:t})}},caption:{get:function(){return this.node.attrs.caption},set:function(t){this.updateAttrs({caption:t})}},disabled:function(){return this.data.includes("data:")}},mounted:function(){var t=this;this.getEditorVm().$watch("selectedEl",(function(e){t.shouldShowClose&&e!==t.$el&&(t.shouldShowClose=!1)}))},methods:{handleKeydown:function(t){var e=this.view.state.tr,n=this.getPos();if("Enter"===t.key){var i=f["i"].create(e.doc,n+2,n+2);this.view.dispatch(e.setSelection(i)),this.view.focus(),t.preventDefault()}},deleteNode:function(){var t=this.view.state.tr,e=this.getPos(),n=f["i"].create(t.doc,e,e+1);this.view.dispatch(t.setSelection(n).deleteSelection(this.src)),this.view.focus()},handlePlayerError:function(t){this.options.handleError(t,"audio-media")},handlePlayerClick:function(t){var e=t.target,n=this.$el.querySelector(".player-button");this.setCursorBelowBlock(),n.contains(e)||(K(this.data)||(this.shouldShowClose=!this.shouldShowClose),this.options.onSelection(this.shouldShowClose?this.$el:""))},onLoadedMetaData:function(){var t,e,n,i;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:if(t=document.getElementById("audio-input"),!this.data.includes("data:")||0==t.files.length){o.next=18;break}return e=t.files[0],n=new FormData,n.append("audio",e),o.prev=5,o.next=8,regeneratorRuntime.awrap(this.options.uploadAudio(n));case 8:i=o.sent,i&&200===i.status&&(this.src=i.data.audio,this.data=i.data.audio),o.next=15;break;case 12:o.prev=12,o.t0=o["catch"](5),this.deleteNode();case 15:return o.prev=15,t.value="",o.finish(15);case 18:case"end":return o.stop()}}),null,this,[[5,12,15,18]])},setCursorBelowBlock:function(){var t=this.getPos()+2;this.editor.focus(t,t)}}},Ut=zt,Lt=Object(P["a"])(Ut,Dt,$t,!1,null,null,null),Rt=Lt.exports,Vt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t.src,i=t.addAudioAt;return function(t,o){var r=t.tr,s=t.schema;r.doc.content.size-i===1&&(r=r.insert(r.doc.content.size,s.nodes["paragraph"].create()));var a=f["i"].create(r.doc,i,i);return r=r.setSelection(a).replaceSelectionWith(e.create({src:n})),o(r)}}}},{key:"name",get:function(){return"audio"}},{key:"schema",get:function(){return{attrs:{src:{default:""},caption:{default:""}},group:"block",selectable:!1,parseDOM:[{tag:this.name,getAttrs:function(t){return{src:t.getAttribute("src"),caption:t.getAttribute("caption")}}}],toDOM:function(t){return["audio",t.attrs]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view","getPos","options","editor"],components:{Audio:Rt},template:"\n        <Audio\n          :node='this.node'\n          :updateAttrs='this.updateAttrs'\n          :view='this.view'\n          :getPos='this.getPos'\n          :options='this.options'\n          :editor='this.editor'\n        ></Audio>\n      "}}}]),e}(f["f"]),Ft=(n("7db0"),n("a15b"),n("2ca0"),n("576a")),Bt=function(t){function e(){return Object(w["a"])(this,e),Object(Z["a"])(this,Object(tt["a"])(e).apply(this,arguments))}return Object(et["a"])(e,t),Object(y["a"])(e,[{key:"name",get:function(){return"placeholder"}},{key:"defaultOptions",get:function(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",emptyNodeText:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0}}},{key:"update",get:function(){return function(t){t.updateState(t.state)}}},{key:"plugins",get:function(){var t=this;return[new f["g"]({props:{decorations:function(e){var n=e.doc,i=e.plugins,o=e.selection,r=i.find((function(t){return t.key.startsWith("editable$")})),s=r.props.editable(),a=s||!t.options.showOnlyWhenEditable,c=o.anchor,d=[];return!!a&&(n.descendants((function(e,n){var i=c>=n&&c<=n+e.nodeSize,o="header"===e.type.name,r=o||"paragraph"===e.type.name,s=0===e.content.size||o&&2===e.content.size;if((i||!t.options.showOnlyCurrent)&&s&&r){var a=[t.options.emptyNodeClass],u=o?n+1:n,l=o?n+e.firstChild.nodeSize+1:n+e.nodeSize,h=Ft["Decoration"].node(u,l,{class:a.join(" "),"data-empty-text":"function"===typeof t.options.emptyNodeText?t.options.emptyNodeText(e):t.options.emptyNodeText});d.push(h)}return!1})),Ft["DecorationSet"].create(n,d))}}})]}}]),e}(f["d"]);function Ht(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}var qt={type:"doc",content:[{type:"featuredimage",attrs:{src:"",caption:"",alt:""}},{type:"paragraph"}]},Wt={name:"Article",props:{onUpdatePost:{type:Function,required:!0},content:{type:Object,default:function(){return qt},required:!0},title:{type:String,required:!1},uploadImage:{type:Function,required:!0},uploadAudio:{type:Function,required:!0},getEmbeds:{type:Function,required:!0},handleError:{type:Function,default:function(){}},beforeUpload:{type:Function,default:function(){return!0}}},components:{EditorContent:f["c"],EditorFloatingMenu:_,EditorMenuBubble:Q},data:function(){var t=this;return{error:{occurred:!1,message:"",name:""},data:this.content,editable:!0,selectedEl:void 0,editor:new f["b"]({autoFocus:!1,editable:!0,extensions:[new nt,new m["b"],new m["a"],new m["h"],new yt,new Ot,new Bt({showOnlyCurrent:!1,emptyNodeText:this.emptyNodeText}),new m["c"],new m["d"]({levels:[3,5]}),new m["j"],new m["k"],new m["i"],new m["e"],new m["l"]({node:"paragraph",notAfter:["paragraph"]}),new bt({uploadImage:this.uploadImage,onSelection:this.onSelection}),new Vt({uploadAudio:this.uploadAudio,handleError:this.handleError,onSelection:this.onSelection}),new Mt({uploadImage:this.uploadImage,onSelection:this.onSelection}),new dt({getEmbeds:this.getEmbeds,onSelection:this.onSelection}),new kt,new It],onUpdate:function(e){var n=e.getJSON,i=n(),o=t.editor.state.doc.firstChild.textContent;i.content.shift(),i.content=i.content.filter((function(t){return!("image"===t.type&&t.attrs.src&&t.attrs.src.fallback.includes("data:")||"audio"===t.type&&t.attrs.src&&t.attrs.src.includes("data:"))})),t.onUpdatePost({blocks:i,title:o})},editorProps:{handlePaste:function(e,n,i){var o=0==i.openStart&&0==i.openEnd&&1==i.content.childCount?i.content.firstChild:null,r=o?e.state.tr.replaceSelectionWith(o,e.shiftKey):e.state.tr.replaceSelection(i),s=r.selection.anchor,a=Object(v["findChildren"])(r.doc,(function(t){return"featuredimage"===t.type.name}),!1);if(a.length>1){var c=f["i"].create(r.doc,a[1].pos,a[1].pos+1);r=r.setSelection(c).deleteSelection(),c=f["i"].create(r.doc,s,s),r=r.setSelection(c)}return e.dispatch(r.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),t.handleAfterPaste(e),!0},handleDOMEvents:{beforeinput:function(e,n){if($.chrome&&$.android&&"deleteContentBackward"==n.inputType){var i=e.state.selection.$cursor,o=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==o){var n=e.state.selection.$cursor;e.dom.blur(),i.pos!==n.pos?t.editor.focus(i.pos,i.pos):t.editor.focus(),e.someProp("handleKeyDown",(function(t){return t(e,Ht(8,"Backspace"))}))||n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())}}),50)}return!0},keydown:function(t,e){return 13===e.keyCode&&(t.selectionAtEnterKeydown=t.state.selection),!1}}}})}},provide:function(){var t=this;return{getEditorVm:function(){return t}}},mounted:function(){var t=this.addTitle(this.content||qt,this.title);this.editor.setContent(t,!1),window.view=this.editor.view},methods:{addTitle:function(t,e){if(0!==t.content.length){var n=t;return n.content=[{type:"header",content:[{type:"title",content:e?[{type:"text",text:e}]:[]}]}].concat(Object(p["a"])(n.content)),n}},emptyNodeText:function(t){if("header"===t.type.name)return"Title";if(this.editor){var e=this.editor.state.doc;if(3===e.childCount&&"paragraph"===t.type.name&&!this.$refs.floatingMenu.shouldShowMenu)return"Start writing here"}return""},handleAfterPaste:function(t){var e=t.state,n=t.dispatch,i=e.doc,o=e.schema,r=e.tr,s=e.selection,a=i.childAfter(s.anchor+1);if(a.node&&"paragraph"===a.node.type.name&&2===a.node.nodeSize)this.editor.setSelection(s.anchor+2,s.anchor+2);else if(!a.node&&i.content.size===s.anchor+1){var c=o.nodes["paragraph"],d=r.insert(i.content.size,c.create());n(d),this.editor.setSelection(s.anchor+2,s.anchor+2)}},onSelection:function(t){this.selectedEl=t}},watch:{editable:function(){this.editor.setOptions({editable:this.editable})}}},Kt=Wt,Jt=(n("720e"),Object(P["a"])(Kt,l,h,!1,null,null,null)),Xt=Jt.exports;n("a24a"),n("9e07"),n("4a82");function Yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(n),!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qt={type:"doc",content:[{type:"featuredimage",attrs:{src:"",caption:"",alt:""}},{type:"paragraph"}]},Zt={name:"Demo",data:function(){return{blocks:{}}},components:{Article:Xt,VueJsonPretty:u.a},methods:{uploadImage:function(){},uploadAudio:function(){},getEmbeds:function(){},onUpdatePost:function(t){var e=t.blocks,n=t.title,i=void 0===n?"":n;this.blocks=Gt({title:i},e)},getContent:function(){return Qt}}},te=Zt,ee=(n("0436"),Object(P["a"])(te,s,a,!1,null,null,null)),ne=ee.exports,ie={name:"App",components:{Demo:ne}},oe=ie,re=Object(P["a"])(oe,o,r,!1,null,null,null),se=re.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(se)}}).$mount("#app")},"720e":function(t,e,n){"use strict";var i=n("a60b"),o=n.n(i);o.a},"77eb":function(t,e,n){},"9e07":function(t,e,n){},a24a:function(t,e,n){},a60b:function(t,e,n){},f397:function(t,e,n){}});
//# sourceMappingURL=app.7b125223.js.map